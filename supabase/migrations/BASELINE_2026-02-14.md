# Baseline 2026-02-14

Este baseline deja operativa la plataforma multi-tenant para catalogos por colegio.

## Scripts base

1. `supabase/migrations/22_sync_backend_contract.sql`
   1. Helpers de tenant (`current_tenant_id`, `is_platform_admin`, `is_tenant_admin`)
   2. `business_days_between`
   3. Vista `v_control_unificado` alineada al frontend

2. `supabase/migrations/23_catalog_staging_and_onboarding.sql`
   1. Compatibilidad de esquema para catalogos por `tenant_id`
   2. Tablas staging (`catalog_staging_batches`, `stg_*`)
   3. Validacion automatica (`validate_college_catalogs`)
   4. Publicacion one-click (`apply_college_catalogs`)
   5. Onboarding automatico (`onboard_college`)

## Orden de ejecucion recomendado

1. Ejecutar `22_sync_backend_contract.sql`
2. Ejecutar `23_catalog_staging_and_onboarding.sql`
3. Validar:
   1. `select public.onboard_college('colegio-demo','Colegio Demo','admin@demo.cl', null, 'basic', 14);`
   2. `select * from public.validate_college_catalogs('<tenant_uuid>'::uuid);`
   3. `select public.apply_college_catalogs('<tenant_uuid>'::uuid);`

## Nota operativa

Desde este baseline, cada colegio puede personalizar `conduct_types`, `conduct_catalog`, `stage_sla` y `action_types` sin afectar a otros tenants.
